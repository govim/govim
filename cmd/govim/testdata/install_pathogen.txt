# Test the Pathogen install approach

[short] skip
[!net] skip

env HOME=$WORK/home
env GOPATH=$CURRENT_GOPATH
env GOVIMTEST_SOCKET=
env GOVIMTESTDRIVER_SOCKET=

exec git clone -q $PLUGIN_PATH $HOME/.vim/bundle/govim

mkdir $HOME/.vim/autoload
mkdir $HOME/.vim/bundle
exec curl -LSso $HOME/.vim/autoload/pathogen.vim https://tpo.pe/pathogen.vim

execvim --not-a-term +'sleep 2' +'execute "normal \"=GOVIMHello()\<C-M>p"' +'w test' +qall
! stdout .+
! stderr .+
cmp test test.golden

-- home/.vimrc --
execute pathogen#infect()
syntax on
filetype plugin indent on

-- test.golden --
Hello from function

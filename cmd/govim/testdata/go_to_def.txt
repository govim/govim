# Test that GOVIMGoToDef works

vim ex 'e p.go'
vim ex 'call cursor(5,16)'
vim ex 'GOVIMGoToDef'

# buffer name
vim expr 'bufname(\"\")'
stdout '^\Q"'$WORK'/q/q.go"\E$'
! stderr .+

# cursor line number
vim expr 'getcurpos()[1]'
stdout '^3$'
! stderr .+

# cursor col position
vim expr 'getcurpos()[2]'
stdout '^7$'
! stderr .+

-- go.mod --
module mod.com/p

replace mod.com/q => ./q

-- p.go --
package p

import "mod.com/q"

const Name = q.Name

-- q/go.mod --
module mod.com/q

-- q/q.go --
package q

const Name = "package q"
